<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Member List App</title>
<style>
body{margin:0;font-family:system-ui,Arial,sans-serif;background:#f4f6f9;color:#111}
header{display:flex;align-items:center;padding:12px 16px;background:#0b63d6;color:white;gap:12px;flex-wrap:wrap}
header h1{font-size:18px;margin:0}
#controls{display:flex;gap:8px;align-items:center;margin-left:auto;flex-wrap:wrap}
.btn{background:white;color:#0b63d6;border:none;padding:8px 12px;border-radius:8px;cursor:pointer}
.btn.primary{background:#0b63d6;color:white}
#app{display:flex;height:calc(100vh - 60px);overflow:hidden}
#sidebar{width:320px;padding:12px;box-sizing:border-box;border-right:1px solid #e4e7eb;background:white;overflow:auto}
#main{flex:1;padding:12px;overflow:auto}
#memberList{display:flex;flex-direction:column;gap:8px}
.memberCard{display:flex;align-items:center;gap:12px;padding:10px;background:white;border-radius:8px;box-shadow:0 1px 2px rgba(0,0,0,.04)}
.memberCard img{width:56px;height:56px;border-radius:8px;object-fit:cover;background:#eee}
.meta{flex:1;cursor:pointer}
.meta h3{margin:0;font-size:15px}
.meta p{margin:0;font-size:12px;color:#666}
.editBtn{background:none;border:none;color:#0b63d6;font-size:18px;cursor:pointer}
#addBtn{position:fixed;right:18px;bottom:18px;width:64px;height:64px;border-radius:50%;font-size:28px;background:#0b63d6;color:white;border:none;cursor:pointer;box-shadow:0 8px 24px rgba(11,99,214,.18)}
.modal{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.4);z-index:60}
.card{background:white;padding:16px;border-radius:10px;max-width:720px;width:100%;max-height:90vh;overflow:auto}
.form-row{display:flex;gap:8px;margin-bottom:10px}
input[type=text],select,textarea,input[type=date],input[type=file]{width:100%;padding:8px;border:1px solid #dfe6ef;border-radius:6px}
textarea{min-height:80px}
.small{font-size:13px;color:#666}
@media(max-width:800px){
#app{flex-direction:column}
#sidebar{width:100%;border-right:none;border-bottom:1px solid #e4e7eb;max-height:260px}
#main{width:100%}
}
</style>
</head>
<body>
<header>
<h1>Member List</h1>
<div id="controls">
<input id="globalSearch" placeholder="Search members..." class="small" style="padding:8px;border-radius:8px;border:none;min-width:180px" />
<select id="categoryFilter">
<option value="">All Categories</option>
<option>Hawker</option>
<option>Customer</option>
<option>Store keeper</option>
<option>Worker</option>
<option>Owner</option>
</select>
</div>
</header>
<div id="app">
<aside id="sidebar">
<div style="display:flex;gap:12px;align-items:center;margin-bottom:12px">
<button id="openAdd" class="btn primary">+ Add</button>
</div>
<div style="font-size:13px;color:#444;margin-bottom:8px">Members</div>
<div id="memberList"></div>
</aside>
<main id="main">
<h2>Member Profile</h2>
<p class="small">Click a member to view full profile.</p>
<div id="profilePanel" style="margin-top:12px"></div>
</main>
</div>

<button id="addBtn" title="Add member">+</button>

<div id="memberModal" class="modal" style="display:none">
<div class="card">
<h3 id="memberModalTitle">Add Member</h3>
<div class="form-row">
<div style="flex:1">
<label class="small">Photo</label>
<input id="photoInput" type="file" accept="image/*">
</div>
<div style="flex:1">
<label class="small">Name</label>
<input id="nameInput" type="text">
</div>
</div>
<div class="form-row">
<div style="flex:1">
<label class="small">Custom ID</label>
<input id="idInput" type="text">
</div>
<div style="flex:1">
<label class="small">Category</label>
<select id="categoryInput">
<option>Hawker</option>
<option>Customer</option>
<option>Store keeper</option>
<option>Worker</option>
<option>Owner</option>
</select>
</div>
</div>
<div style="margin-bottom:8px">
<label class="small">Details</label>
<textarea id="detailInput"></textarea>
</div>
<div class="form-row">
<div style="flex:1">
<label class="small">Date of joining</label>
<input id="dateInput" type="date">
</div>
<div style="flex:1"></div>
</div>
<div style="display:flex;gap:8px;justify-content:flex-end">
<button id="memberCancel" class="btn">Cancel</button>
<button id="memberSave" class="btn primary">Save</button>
</div>
</div>
</div>

<script>
let allMembers={},editKey=null;
const openAdd=document.getElementById('openAdd');
const addBtn=document.getElementById('addBtn');
const memberListEl=document.getElementById('memberList');
const profilePanel=document.getElementById('profilePanel');
const globalSearch=document.getElementById('globalSearch');
const categoryFilter=document.getElementById('categoryFilter');
const memberModal=document.getElementById('memberModal');
const memberModalTitle=document.getElementById('memberModalTitle');
const memberCancel=document.getElementById('memberCancel');
const memberSave=document.getElementById('memberSave');
const photoInput=document.getElementById('photoInput');
const nameInput=document.getElementById('nameInput');
const idInput=document.getElementById('idInput');
const categoryInput=document.getElementById('categoryInput');
const detailInput=document.getElementById('detailInput');
const dateInput=document.getElementById('dateInput');

function saveToStorage(){localStorage.setItem('members',JSON.stringify(allMembers));}
function loadFromStorage(){allMembers=JSON.parse(localStorage.getItem('members')||'{}');}
function renderList(){
const q=(globalSearch.value||'').toLowerCase();
const filterCat=categoryFilter.value||'';
let arr=Object.entries(allMembers).map(([k,v])=>({key:k,...v}));
arr=arr.filter(m=>{if(filterCat&&m.category!==filterCat)return false;const hay=(m.name+' '+(m.customId||'')+' '+(m.detail||'')+' '+(m.category||'')).toLowerCase();if(q&&!hay.includes(q))return false;return true;});
arr.sort((a,b)=>(b.createdAt||0)-(a.createdAt||0));
memberListEl.innerHTML=arr.map(m=>`<div class="memberCard" data-key="${m.key}"><img src="${m.photo||'https://via.placeholder.com/56?text=No'}"><div class="meta"><h3>${m.name} <small style="color:#666;font-size:12px">(${m.category||''})</small></h3><p style="font-size:12px;color:#666">${m.customId||''}</p></div><button class="editBtn">✏️</button></div>`).join('')||'<div style="color:#666">No members</div>';
document.querySelectorAll('.memberCard').forEach(card=>{
const key=card.dataset.key;
card.querySelector('.meta').onclick=()=>showProfile(key);
card.querySelector('.editBtn').onclick=e=>{e.stopPropagation();openEdit(key);};
});
}

function showProfile(key){
const m=allMembers[key];
if(!m){profilePanel.innerHTML='<div style="color:#666">Profile not found</div>';return;}
profilePanel.innerHTML=`<div><h3>${m.name}</h3><p><strong>Category:</strong> ${m.category||''}</p><p><strong>Custom ID:</strong> ${m.customId||''}</p><p><strong>Joined:</strong> ${m.joinDate}</p><p><strong>Details:</strong> ${m.detail||''}</p><img src="${m.photo||'https://via.placeholder.com/120'}" style="width:120px;height:120px;border-radius:8px;object-fit:cover;margin-top:10px"><div style="margin-top:12px"><button onclick="deleteMember('${key}')" class="btn" style="background:#f44336;color:#fff">Delete</button></div></div>`;
}

function deleteMember(key){if(!confirm('Delete?'))return;delete allMembers[key];saveToStorage();renderList();profilePanel.innerHTML='';}

function clearForm(){photoInput.value='';nameInput.value='';idInput.value='';categoryInput.value='Hawker';detailInput.value='';dateInput.value='';}

function openEdit(key){
editKey=key;
const m=allMembers[key];
if(!m)return;
memberModalTitle.textContent='Edit Member';
nameInput.value=m.name||'';
idInput.value=m.customId||'';
categoryInput.value=m.category||'Hawker';
detailInput.value=m.detail||'';
dateInput.value=m.joinDate||'';
photoInput.value='';
memberModal.style.display='flex';
}

openAdd.onclick=addBtn.onclick=()=>{editKey=null;memberModalTitle.textContent='Add Member';clearForm();memberModal.style.display='flex';};
memberCancel.onclick=()=>{memberModal.style.display='none';clearForm();};
memberSave.onclick=()=>{
let key=editKey||Date.now().toString();
let reader=new FileReader();
reader.onload=()=>{
allMembers[key]={name:nameInput.value||'(no name)',customId:idInput.value,category:categoryInput.value,detail:detailInput.value,joinDate:dateInput.value||new Date().toLocaleDateString(),createdAt:Date.now(),photo:reader.result||''};
saveToStorage();renderList();memberModal.style.display='none';clearForm();
};
if(photoInput.files[0])reader.readAsDataURL(photoInput.files[0]);
else{allMembers[key]={name:nameInput.value||'(no name)',customId:idInput.value,category:categoryInput.value,detail:detailInput.value,joinDate:dateInput.value||new Date().toLocaleDateString(),createdAt:Date.now(),photo:allMembers[key]?allMembers[key].photo:''};
saveToStorage();renderList();memberModal.style.display='none';clearForm();}
};

globalSearch.oninput=renderList;
categoryFilter.onchange=renderList;
window.addEventListener('click',e=>{if(e.target===memberModal)memberModal.style.display='none';});
loadFromStorage();
renderList();
</script>
</body>
</html>
